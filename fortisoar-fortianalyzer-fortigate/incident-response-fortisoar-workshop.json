{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "incident-response-fortisoar-workshop",
      "description": null,
      "visible": true,
      "image": null,
      "uuid": "f3206736-5ea3-4313-999b-5f0eb4e156b8",
      "id": 263,
      "createDate": 1651505225.128988,
      "modifyDate": 1651505225.128988,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Incident Response Plan (Type - C&C) - NEW",
          "aliasName": null,
          "tag": null,
          "description": "Investigates incidents of type ‘C&C’ and executes the different phases of incident response using Splunk.",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "incident_iri"
          ],
          "synchronous": false,
          "lastModifyDate": 1654296787,
          "collection": "/api/3/workflow_collections/f3206736-5ea3-4313-999b-5f0eb4e156b8",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/80d50b11-83fa-427c-bf7e-c6ed11686798",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Identify Target System",
              "description": null,
              "arguments": {
                "type": "InputBased",
                "input": {
                  "schema": {
                    "title": "Identify Target System",
                    "description": "<p>Provide the Device ID on which the C&C traffic was found</p>\n\n<p>Hint: check assets tab</p>",
                    "inputVariables": [
                      {
                        "name": "targetSystem",
                        "type": "string",
                        "label": "Target System",
                        "tooltip": "Device ID of which the C&C traffic was found",
                        "dataType": "text",
                        "formType": "text",
                        "required": false,
                        "_expanded": true,
                        "defaultValue": "Device ID",
                        "useRecordFieldDefault": false
                      }
                    ]
                  }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "incidents",
                "owner_detail": {
                  "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Save",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/200696d3-30fe-434d-84ec-45dc6da644a6"
                    }
                  ],
                  "duplicateOption": false
                },
                "email_notification": {
                  "enabled": false,
                  "smtpParameters": []
                }
              },
              "status": null,
              "top": "500",
              "left": "410",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "00dc8318-d6cb-47c1-9865-6d352e5fc163"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Identification",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase changed to <strong>Identification</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 7695,
                    "@id": "/api/3/picklists/37f637f0-2e7a-41cc-a6e4-502d7263b2d0",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Identification",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Identification",
                    "orderIndex": 1
                  },
                  "status": {
                    "id": 7210,
                    "@id": "/api/3/picklists/bb7402d6-f699-11e7-8c3f-9a214cf093ae",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "In Progress",
                    "listName": "/api/3/picklist_names/a549e41c-31ca-406d-89ae-eab3de5c06c4",
                    "itemValue": "In Progress",
                    "orderIndex": 1
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "89",
              "left": "409",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "0a226751-074b-4b6d-8bbc-62390b99cfd2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Eradication",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase changed to&nbsp;<strong>Eradication</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 157,
                    "@id": "/api/3/picklists/bb740a06-f699-11e7-8c3f-9a214cf093ae",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Eradication",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Eradication",
                    "orderIndex": 5
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "108",
              "left": "1545",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "0a8fe66f-749a-45ab-8301-8d45d142cd86"
            },
            {
              "@type": "WorkflowStep",
              "name": "add user DV details",
              "description": null,
              "arguments": {
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>Identified Delivery Vector by user {{vars.steps.Identify_Delivery_Vector.username}} is <strong>{{vars.steps.Identify_Delivery_Vector.input.deliveryVector.itemValue}}</strong></p>",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "400",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "16321386-e35d-48ef-a74a-557a756b122f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "host_list": "[]"
              },
              "status": null,
              "top": "180",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "1f51590d-6596-4f22-8a66-302a75acdd32"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Target Asset",
              "description": null,
              "arguments": {
                "resource": {
                  "targetAsset": "{{vars.steps.Identify_Target_System.input.targetSystem}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "step_variables": []
              },
              "status": null,
              "top": "600",
              "left": "409",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "200696d3-30fe-434d-84ec-45dc6da644a6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Identify Delivery Vector",
              "description": null,
              "arguments": {
                "type": "InputBased",
                "input": {
                  "schema": {
                    "title": "Identify Delivery Vector",
                    "description": "<p>Select how the malware was delivered on the target system</p>",
                    "inputVariables": [
                      {
                        "name": "deliveryVector",
                        "type": "picklists",
                        "label": "Delivery Vector",
                        "title": "Picklist",
                        "usable": true,
                        "tooltip": "",
                        "dataType": "picklist",
                        "formType": "picklist",
                        "required": false,
                        "_expanded": true,
                        "collection": false,
                        "dataSource": {
                          "model": "picklists",
                          "query": {
                            "sort": [
                              {
                                "field": "orderIndex",
                                "direction": "ASC"
                              }
                            ],
                            "logic": "AND",
                            "filters": [
                              {
                                "field": "listName__name",
                                "value": "DeliveryVector",
                                "operator": "eq"
                              }
                            ]
                          }
                        },
                        "searchable": false,
                        "templateUrl": "app/components/form/fields/typeahead.html",
                        "defaultValue": null,
                        "displayTemplate": "{{ itemValue }}",
                        "allowedEncryption": false,
                        "allowedGridColumn": true,
                        "useRecordFieldDefault": false
                      }
                    ]
                  }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                  "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Save",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/2e74416d-bb90-4095-8b8d-e21dc67c61eb"
                    }
                  ],
                  "duplicateOption": false
                }
              },
              "status": null,
              "top": "180",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "2b2e379b-27b1-47eb-9807-2dbc689533e3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Delivery Vector",
              "description": null,
              "arguments": {
                "resource": {
                  "deliveryVector": "{{vars.steps.Identify_Delivery_Vector.input.deliveryVector}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "410",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "2e74416d-bb90-4095-8b8d-e21dc67c61eb"
            },
            {
              "@type": "WorkflowStep",
              "name": "No Binary file comment",
              "description": null,
              "arguments": {
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p><strong>No Binary File Identified by user \"{{vars.steps.Upload_Binary_Input.input.Username}}\"&nbsp;</strong></p>",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1000",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "349edc27-132e-458b-9d1d-676260b11a59"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Confirmation",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase Changed to&nbsp;<strong>Confirmation</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 7694,
                    "@id": "/api/3/picklists/cbaa92d2-6fd7-4dbe-88f6-0e0d17e8b430",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Confirmation",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Confirmation",
                    "orderIndex": 2
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "100",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "5ae13628-d09a-446d-9d08-8b2bf4fa913c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Query Splunk for related events for source IP address",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "297ea74f-c96c-4b50-b462-329e9340507d",
                "params": {
                  "query": "index=\"securitylogs\" sourcetype=\"linuxlogs\" rhost=\"{{vars.source_ip}}\" authentication failure | stats count by host",
                  "additional_search_args": "{\"exec_mode\": \"blocking\"}"
                },
                "version": "1.4.0",
                "connector": "splunk",
                "operation": "invoke_search",
                "mock_result": "{\n  \"message\": \"\",\n  \"status\": \"Success\",\n  \"operation\": \"invoke_search\",\n  \"data\": {\n    \"sid\": \"1517475217.90862\"\n  }\n}",
                "operationTitle": "Invoke Search",
                "step_variables": [],
                "operationOutput": {
                  "sid": ""
                }
              },
              "status": null,
              "top": "220",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "601fdce5-cde2-44ad-82c6-5a292106e895"
            },
            {
              "@type": "WorkflowStep",
              "name": "Binary file comment",
              "description": null,
              "arguments": {
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p><strong>Identified Binary File by user \"{{vars.steps.Upload_Binary_Input.input.username}}\" is {{vars.steps.Upload_Binary_Input.input.binaryFile.filename}}&nbsp;}}</strong></p>",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "980",
              "left": "280",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "6ec6e58b-2a15-4a8b-ab03-0eb6a7acb969"
            },
            {
              "@type": "WorkflowStep",
              "name": "update target asset",
              "description": null,
              "arguments": {
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>Identified Target system hostname by user \"{{vars.steps.Identify_Target_System.username}}\" is <strong>{{vars.steps.Identify_Target_System.input.targetSystem}}</strong></p>",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "700",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "7f6dfd65-09a0-4c62-a38c-f316dea1839b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "233a7c64-f3d0-4e86-915b-866a10e66ae4",
                "title": "Incident Response Plan (Type - C&C)",
                "resources": [
                  "incidents"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "params": [],
                    "records": "{{vars.input.records}}"
                  },
                  "useMockOutput": "true"
                },
                "_promptexpanded": true,
                "displayConditions": {
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "phase",
                        "value": "/api/3/picklists/bb740542-f699-11e7-8c3f-9a214cf093ae",
                        "_value": {
                          "@id": "/api/3/picklists/bb740542-f699-11e7-8c3f-9a214cf093ae",
                          "itemValue": "Detection"
                        },
                        "operator": "eq"
                      }
                    ]
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "80d50b11-83fa-427c-bf7e-c6ed11686798"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Aftermath",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase changed to&nbsp;<strong>Aftermath</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 7693,
                    "@id": "/api/3/picklists/10b77cd3-0ba5-4c2e-83bb-d665430a9287",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Aftermath",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Aftermath",
                    "orderIndex": 6
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "106",
              "left": "2220",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "85c8d415-ee02-4da7-98b3-971e1b233734"
            },
            {
              "@type": "WorkflowStep",
              "name": "Add task completed note to Incident",
              "description": null,
              "arguments": {
                "resource": {
                  "hunts": null,
                  "scans": null,
                  "tasks": null,
                  "alerts": null,
                  "assets": null,
                  "emails": null,
                  "events": null,
                  "owners": null,
                  "people": null,
                  "content": "<p>Incident response process is completed. Incident can be marked <span style=\"color: #008000;\"><strong>Resolved</strong></span> now</p>",
                  "approvals": null,
                  "campaigns": null,
                  "companies": null,
                  "evidences": null,
                  "incidents": "['{{vars.input.records[0]['@id']}}']",
                  "isDeleted": null,
                  "indicators": null,
                  "attachments": null,
                  "legalMatters": null,
                  "vulnerabilities": null
                },
                "_showJson": false,
                "collection": "/api/3/comments",
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "2220",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "87556d28-5a2e-42d7-9a80-6992ffee0bc5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Add details of Splunk query to record",
              "description": null,
              "arguments": {
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>Queried Splunk, and found similar traffic as {{vars.steps.Identify_Target_System.input.targetSystem}} &nbsp;on following<span style=\"color: #ff0000;\">&nbsp;</span><strong>{{ vars.steps.Retrieve_Splunk_query_results.data.results | length }} </strong>systems</p>\n<ul style=\"list-style-type: square;\">{% for i in vars.steps.Retrieve_Splunk_query_results.data.results %} {% set system = i['host'] %}\n<li>{{ system }}</li>\n{% endfor %}</ul>",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "8ba7df92-3818-49e0-8b97-3d940c7f7ff2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Recovery",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase changed to&nbsp;<strong>Recovery</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 178,
                    "@id": "/api/3/picklists/bb740d30-f699-11e7-8c3f-9a214cf093ae",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Recovery",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Recovery",
                    "orderIndex": 6
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "108",
              "left": "1880",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "a2c8e2a7-76af-4af7-9304-0d39583687e2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Binary File Indicator 1",
              "description": null,
              "arguments": {
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "<p>Binary File Indicator has been created and linked.</p>",
                  "records": ""
                },
                "resource": {
                  "file": "{{vars.steps.Upload_Binary_Input.input.binaryFile['@id'] or None}}",
                  "value": "{{vars.steps.Upload_Binary_Input.input.binaryFile.filename}}",
                  "__replace": "",
                  "incidents": "{{vars.input.records[0]['@id']}}",
                  "typeofindicator": {
                    "id": 73,
                    "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "File",
                    "listName": "/api/3/picklist_names/50ee5bfa-e18f-49ba-8af9-dcca25b0f9c0",
                    "itemValue": "File",
                    "orderIndex": 3
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "1120",
              "left": "580",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "a681e085-91c8-40af-83a9-c0e83876bb5b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Write a Procedure",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Please check task -&nbsp;<span style=\"text-decoration: underline;\"><strong>{{vars.result.id}}</strong></span>&nbsp;&nbsp;to&nbsp;write a procedure for detecting, investigating and remediating identified malware</p>",
                  "records": ""
                },
                "resource": {
                  "hunt": null,
                  "name": "Write a procedure on how to remove the malware",
                  "type": null,
                  "dueBy": null,
                  "alerts": null,
                  "assets": null,
                  "owners": null,
                  "status": {
                    "id": 412,
                    "@id": "/api/3/picklists/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "icon": null,
                    "uuid": "7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "@type": "Picklist",
                    "color": "#928f8f",
                    "display": "Open",
                    "listName": "/api/3/picklist_names/21ddbcfd-b4a3-4273-adea-c674fe47d643",
                    "itemValue": "Open",
                    "importedBy": [],
                    "orderIndex": 3
                  },
                  "stepid": null,
                  "persons": null,
                  "comments": null,
                  "priority": null,
                  "taskdata": null,
                  "tasktype": null,
                  "warrooms": null,
                  "companies": null,
                  "incidents": "['{{vars.input.records[0]['@id']}}']",
                  "startDate": null,
                  "taskTeams": {
                    "id": 125,
                    "@id": "/api/3/picklists/52db93a5-6a18-4bf3-80b4-059351119d76",
                    "icon": null,
                    "uuid": "52db93a5-6a18-4bf3-80b4-059351119d76",
                    "@type": "Picklist",
                    "color": null,
                    "display": "SOC Team",
                    "listName": "/api/3/picklist_names/30efdc50-1f3d-40d3-909f-e71386dea13e",
                    "itemValue": "SOC Team",
                    "importedBy": [],
                    "orderIndex": 0
                  },
                  "indicators": null,
                  "recordTags": null,
                  "userOwners": null,
                  "workflowid": null,
                  "workspaces": null,
                  "attachments": null,
                  "description": "<p>Reference Links</p>\n<ul>\n<li>Remove malware from&nbsp;<a href=\"https://heimdalsecurity.com/blog/malware-removal/\">window machine</a>&nbsp;</li>\n<li>Remove malware from&nbsp;<a href=\"https://www.techrepublic.com/article/how-to-scan-and-clean-malware-from-a-linux-server/\">Linux machine</a>&nbsp;</li>\n</ul>",
                  "submittedBy": {
                    "id": 3,
                    "@id": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                    "type": null,
                    "uuid": "3451141c-bac6-467c-8d72-85e0fab569ce",
                    "@type": "Person",
                    "email": "epackard@fortinet.com",
                    "roles": [
                      "/api/3/roles/17562d60-b841-4ed7-912b-1ebaf063c8c9",
                      "/api/3/roles/21d7a7c6-9d68-438f-b732-e8950c5f745b",
                      "/api/3/roles/c5ff8174-b3fa-41c5-b781-2b890b426a80"
                    ],
                    "tasks": [],
                    "teams": [
                      "/api/3/teams/6e569c09-3bd4-40f1-98b0-cc994464c3c5"
                    ],
                    "title": "Admin",
                    "alerts": [],
                    "avatar": null,
                    "shifts": [],
                    "userId": "765472c6-0544-41df-ad3c-ee8e70ef068b",
                    "display": "CS Admin",
                    "@context": "/api/3/contexts/Person",
                    "comments": [],
                    "csActive": true,
                    "lastname": "Admin",
                    "phoneFax": null,
                    "userType": null,
                    "@settings": {
                      "user": {
                        "view": {
                          "theme": "steel",
                          "details": {
                            "alerts": {
                              "subtabs": {
                                "Indicators": "indicators"
                              },
                              "workspace": {
                                "tab": "comments"
                              },
                              "openCollab": true,
                              "selectedTab": "Source Data"
                            },
                            "incidents": {
                              "subtabs": {
                                "Tasks": "tasks",
                                "Indicators": "indicators",
                                "Correlations": "alerts"
                              },
                              "openCollab": true,
                              "selectedTab": "Tasks"
                            },
                            "onboarding-guide": {
                              "onboardingSetupLater": true
                            }
                          }
                        },
                        "phone": {
                          "countryId": "US"
                        },
                        "global": {
                          "timezone": {
                            "timezone_type": 3
                          }
                        },
                        "notifications": {
                          "sms": false,
                          "web": false,
                          "email": true,
                          "commentMentionEmailNotifications": true,
                          "enableCommentMentionNotifications": true
                        }
                      },
                      "playbook": {
                        "logs": {
                          "tags": [
                            {
                              "uuid": "system"
                            }
                          ],
                          "filterOpration": "exclude"
                        },
                        "autosave": true,
                        "autosaveTime": 15
                      },
                      "navigation": {
                        "collapsed": true
                      },
                      "globalFilters": {
                        "people": {
                          "showActiveUsers": true
                        }
                      },
                      "authentication": {
                        "sitekey": "6Lc75kcUAAAAAHg7-4xLEcTfzryh64REbPr_CRqo",
                        "loginMessage": "All material beyond this point is to be viewed only by users authorized by FortiSOAR."
                      },
                      "recommendation": {
                        "strategy": "falconBased"
                      },
                      "auditlog_ttl_config": {
                        "ttl": 0,
                        "enabled": false
                      },
                      "commentModification": {
                        "enabled": true,
                        "softDelete": true,
                        "timeWindow": 300
                      },
                      "workflow_log_config": {
                        "debug": false,
                        "failed_workflow": false,
                        "allow_pb_to_override": true
                      },
                      "workflow_ttl_config": {
                        "ttl": 15,
                        "enabled": true
                      },
                      "workflow_vacuum_config": {
                        "ttl": "7",
                        "enabled": true
                      }
                    },
                    "companyId": null,
                    "firstname": "CS",
                    "fsrQueues": [
                      "/api/3/fsr_queues/4cf6073b-319d-4c30-887c-f642adfede82"
                    ],
                    "incidents": [],
                    "phoneHome": null,
                    "phoneWork": "+16462759691",
                    "trackable": true,
                    "accessType": "Named",
                    "createDate": 1650470216,
                    "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                    "department": null,
                    "indicators": [],
                    "modifyDate": 1652828068.668577,
                    "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
                    "attachments": [],
                    "defaultSort": false,
                    "description": null,
                    "displayName": "CS Admin",
                    "phoneMobile": null,
                    "@permissions": {
                      "hunt": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "files": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "roles": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "rules": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "tasks": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "teams": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "actors": {
                        "read": true,
                        "clone": false,
                        "create": false,
                        "delete": false,
                        "update": false,
                        "execute": false
                      },
                      "agents": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "alerts": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "assets": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "events": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "people": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "shifts": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "queries": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "routers": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "tenants": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "widgets": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "comments": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "security": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "settings": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "warrooms": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "approvals": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "campaigns": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "companies": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "dashboard": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "incidents": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "picklists": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "reporting": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "schedules": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "workflows": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "activities": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": false,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "appliances": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "connectors": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "contentHub": {
                        "read": true,
                        "clone": false,
                        "create": false,
                        "delete": false,
                        "fields": [],
                        "update": false,
                        "execute": false
                      },
                      "fsr_queues": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "indicators": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "workspaces": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "application": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "attachments": {
                        "read": true,
                        "clone": false,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "export_jobs": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "import_jobs": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "mitre_groups": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "sla_template": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "announcements": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "communication": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "data_archival": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "mitre_tactics": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "saved_reports": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "solutionpacks": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "mitre_software": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "email_templates": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "mitre_techniques": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "rule_collections": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "mitre_mitigations": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "threat_intel_feeds": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": false
                      },
                      "mitre_sub_techniques": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      },
                      "workflow_collections": {
                        "read": true,
                        "clone": true,
                        "create": true,
                        "delete": true,
                        "fields": [],
                        "update": true,
                        "execute": true
                      }
                    },
                    "_currentUser": true,
                    "_highlighted": true,
                    "descriptions": {
                      "plural": "People",
                      "singular": "Person"
                    },
                    "displayTemplate": "{{ firstname }} {{ lastname }}"
                  },
                  "approvalhost": null,
                  "actualMinutes": null,
                  "assignedOnDate": "{{globalVars.Current_Date}}",
                  "completedOnDate": null,
                  "assignedToPerson": "{{globalVars.Current_User}}",
                  "threatIntelFeeds": null
                },
                "collection": "tasks",
                "step_variables": []
              },
              "status": null,
              "top": "248",
              "left": "1540",
              "stepType": "/api/3/workflow_step_types/dc6ac63d-c5a5-472f-9eb4-6b18473a98b8",
              "uuid": "b1b259b2-a625-4f47-9819-eb392144fd6e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start instances",
              "description": null,
              "arguments": {
                "name": "Azure Compute",
                "config": "a63dab87-7eda-400f-aeb8-0dd6db37ed05",
                "params": {
                  "subs_id": "FTNT-Training",
                  "vm_name": "{{vars.steps.Identify_Target_System.input.targetSystem}}",
                  "resource_group_name": "cse02_fortisoar_fortianalyzer_fortigate"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "<p><span style=\"background-color: #2dc26b;\">Playbook has Restarted Machines as user {{globalVars.Current_User}} has cleaned them</span></p>",
                  "records": ""
                },
                "version": "1.0.0",
                "connector": "azure-compute",
                "operation": "start_instance",
                "operationTitle": "Start an Instance",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "1880",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b8aad193-8889-4937-a45b-6b56e9cf6194"
            },
            {
              "@type": "WorkflowStep",
              "name": "Stop instances",
              "description": null,
              "arguments": {
                "name": "Azure Compute",
                "config": "a63dab87-7eda-400f-aeb8-0dd6db37ed05",
                "params": {
                  "subs_id": "FTNT-Training",
                  "vm_name": "{{vars.steps.find_asset[0].name}}",
                  "resource_group_name": "cse01_fortisoar_fortianalyzer_fortigate"
                },
                "message": {
                  "tags": [],
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "tenant": "",
                  "content": "<p><span style=\"background-color: #e03e2d;\">Playbook shut down Endpoints due to malicious activity</span></p>",
                  "records": ""
                },
                "version": "1.0.0",
                "for_each": {
                  "item": "{{vars.steps.Retrieve_Splunk_query_results.data}}",
                  "parallel": false,
                  "condition": ""
                },
                "connector": "azure-compute",
                "operation": "stop_instance",
                "mock_result": "{{Sucess}}",
                "operationTitle": "Stop an Instance",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "260",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "bde6e19b-bf87-4ad1-9f95-1fc5b4e8674e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Phase to Containment",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Phase Changed to&nbsp;<strong>Containment</strong></p>",
                  "records": ""
                },
                "resource": {
                  "phase": {
                    "id": 147,
                    "@id": "/api/3/picklists/bb7407e0-f699-11e7-8c3f-9a214cf093ae",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "Containment",
                    "listName": "/api/3/picklist_names/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                    "itemValue": "Containment",
                    "orderIndex": 4
                  }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/incidents",
                "fieldOperation": {
                  "category": "Append",
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "108",
              "left": "1180",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "c725d6c1-3d9a-4e1a-9fbb-3b14e07db2fe"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Binary File Hash",
              "description": "",
              "arguments": {
                "params": {
                  "iri": "{{vars.steps.Upload_Binary_Input.input.binaryFile['@id']}}"
                },
                "version": "2.6.0",
                "connector": "cyops_utilities",
                "operation": "download_file_from_cyops",
                "operationTitle": "File: Compute Hash",
                "step_variables": []
              },
              "status": null,
              "top": "900",
              "left": "60",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "ce88e54d-78ae-4c45-ace9-8c9e8d77731c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Upload Binary Input",
              "description": null,
              "arguments": {
                "type": "InputBased",
                "input": {
                  "schema": {
                    "title": "Upload Binary File",
                    "description": "<p>Provide the Binary file found on the target system (hint: you have no Binary file)</p>",
                    "inputVariables": [
                      {
                        "name": "binaryFile",
                        "type": "string",
                        "label": "Binary File",
                        "title": "File Field",
                        "usable": true,
                        "tooltip": "Upload Binary File found on Target System",
                        "dataType": "file",
                        "formType": "file",
                        "required": false,
                        "_expanded": true,
                        "collection": false,
                        "dataSource": {
                          "model": "files"
                        },
                        "searchable": false,
                        "templateUrl": "app/components/form/fields/file.html",
                        "defaultValue": "None",
                        "allowedEncryption": true,
                        "allowedGridColumn": true,
                        "useRecordFieldDefault": false
                      }
                    ]
                  }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "incidents",
                "owner_detail": {
                  "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                  "options": [
                    {
                      "option": "Upload",
                      "primary": false,
                      "step_iri": "/api/3/workflow_steps/ce88e54d-78ae-4c45-ace9-8c9e8d77731c"
                    },
                    {
                      "option": "No Binary Found",
                      "primary": true,
                      "step_iri": "/api/3/workflow_steps/349edc27-132e-458b-9d1d-676260b11a59"
                    }
                  ],
                  "duplicateOption": false
                },
                "email_notification": {
                  "enabled": false,
                  "smtpParameters": []
                }
              },
              "status": null,
              "top": "800",
              "left": "409",
              "stepType": "/api/3/workflow_step_types/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
              "uuid": "d7f6fb34-cd60-4bb0-9850-a1a86b58d12d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Retrieve Splunk query results",
              "description": null,
              "arguments": {
                "name": "Splunk",
                "config": "297ea74f-c96c-4b50-b462-329e9340507d",
                "params": {
                  "sid": "{'value': '{{vars.steps.Query_Splunk_for_related_events_for_source_IP_address.data.sid}}'}",
                  "additional_args": ""
                },
                "version": "1.6.2",
                "connector": "splunk",
                "operation": "get_results",
                "mock_result": "{\n  \"message\": \"\",\n  \"status\": \"Success\",\n  \"operation\": \"get_results\",\n  \"data\": {\n    \"messages\": [],\n    \"results\": [\n        {\n        \"host\": \"LinEp31\",\n        \"count\": \"30\"\n      },\n      {\n        \"host\": \"LinEp41\",\n        \"count\": \"10\"\n      },\n      {\n        \"host\": \"LinEp51\",\n        \"count\": \"10\"\n      },\n      {\n        \"host\": \"LinEp61\",\n        \"count\": \"10\"\n      },\n      {\n        \"host\": \"LinEp71\",\n        \"count\": \"10\"\n      }\n    ],\n    \"highlighted\": {},\n    \"fields\": [\n      {\n        \"name\": \"host\",\n        \"groupby_rank\": \"0\"\n      },\n      {\n        \"name\": \"count\"\n      }\n    ],\n    \"init_offset\": 0,\n    \"preview\": false\n  }\n}",
                "operationTitle": "Get Results for a Search",
                "step_variables": {
                  "h_affected_host": "{% for i in vars.result.data.results %}      {% set alert_id = vars.request.data.records[0]['@id'] %}  {{ vars.host_list.append([alert_id,i['host']]) }}     {% endfor %}"
                },
                "operationOutput": {
                  "fields": [],
                  "preview": false,
                  "results": [],
                  "messages": [],
                  "highlighted": [],
                  "init_offset": 0
                }
              },
              "status": null,
              "top": "320",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e08077af-bd9a-4098-aeb3-c9e07b130dc5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Restore Corrupted Files",
              "description": null,
              "arguments": {
                "message": {
                  "tenant": "",
                  "content": "<p>Please check task -&nbsp;<span style=\"text-decoration: underline;\"><strong>{{vars.result.id}}</strong></span>&nbsp;&nbsp;to identify and restore corrupted files on customer systems</p>",
                  "records": ""
                },
                "resource": {
                  "hunt": null,
                  "name": "Identify and restore possibly corrupted files",
                  "type": null,
                  "dueBy": null,
                  "alerts": null,
                  "assets": null,
                  "owners": null,
                  "status": {
                    "id": 412,
                    "@id": "/api/3/picklists/7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "icon": null,
                    "uuid": "7669725a-28cc-4b19-98a3-9ca71e0f88f4",
                    "@type": "Picklist",
                    "color": "#928f8f",
                    "display": "Open",
                    "listName": "/api/3/picklist_names/21ddbcfd-b4a3-4273-adea-c674fe47d643",
                    "itemValue": "Open",
                    "importedBy": [],
                    "orderIndex": 3
                  },
                  "stepid": null,
                  "persons": null,
                  "comments": null,
                  "priority": {
                    "id": 54,
                    "@id": "/api/3/picklists/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "icon": null,
                    "uuid": "90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                    "@type": "Picklist",
                    "color": "#e36c29",
                    "display": "High",
                    "listName": "/api/3/picklist_names/bea9a490-50d1-4597-8ad9-24422e10676e",
                    "itemValue": "High",
                    "importedBy": [],
                    "orderIndex": 2
                  },
                  "taskdata": null,
                  "tasktype": null,
                  "warrooms": null,
                  "companies": null,
                  "incidents": "['{{vars.input.records[0]['@id']}}']",
                  "startDate": null,
                  "taskTeams": null,
                  "indicators": null,
                  "recordTags": null,
                  "userOwners": null,
                  "workflowid": null,
                  "workspaces": null,
                  "attachments": null,
                  "description": "<p>&nbsp;Reference Links</p>\n<ul>\n<li>Restore&nbsp;<a href=\"https://support.microsoft.com/en-in/help/929833/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system\">Windows corrupted file</a></li>\n<li>Restore<a href=\"https://www.tecmint.com/fsck-repair-file-system-errors-in-linux/\"> Linux corrupted file</a></li>\n</ul>",
                  "submittedBy": null,
                  "approvalhost": null,
                  "actualMinutes": null,
                  "assignedOnDate": "{{globalVars.Current_Date}}",
                  "completedOnDate": null,
                  "assignedToPerson": "{{globalVars.Current_User}}",
                  "threatIntelFeeds": null
                },
                "collection": "tasks",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "1880",
              "stepType": "/api/3/workflow_step_types/dc6ac63d-c5a5-472f-9eb4-6b18473a98b8",
              "uuid": "ed0f8624-de7d-45c7-9020-44eb261762bf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Delivery Vector -> add user DV details",
              "targetStep": "/api/3/workflow_steps/16321386-e35d-48ef-a74a-557a756b122f",
              "sourceStep": "/api/3/workflow_steps/2e74416d-bb90-4095-8b8d-e21dc67c61eb",
              "label": null,
              "isExecuted": false,
              "uuid": "0a4ec9a0-e8e8-4146-9176-4dcf6bbd253c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start instances -> Set Phase to Aftermath",
              "targetStep": "/api/3/workflow_steps/85c8d415-ee02-4da7-98b3-971e1b233734",
              "sourceStep": "/api/3/workflow_steps/b8aad193-8889-4937-a45b-6b56e9cf6194",
              "label": null,
              "isExecuted": false,
              "uuid": "0ed9d628-952e-4573-9999-d7d6b574d9fe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Write a Procedure -> Update Incident Phase to Recovery",
              "targetStep": "/api/3/workflow_steps/a2c8e2a7-76af-4af7-9304-0d39583687e2",
              "sourceStep": "/api/3/workflow_steps/b1b259b2-a625-4f47-9819-eb392144fd6e",
              "label": null,
              "isExecuted": false,
              "uuid": "0ffd3fef-dad7-41c6-868d-388a3cab09d2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Retrieve Splunk query results -> Add details of Splunk query to record",
              "targetStep": "/api/3/workflow_steps/8ba7df92-3818-49e0-8b97-3d940c7f7ff2",
              "sourceStep": "/api/3/workflow_steps/e08077af-bd9a-4098-aeb3-c9e07b130dc5",
              "label": null,
              "isExecuted": false,
              "uuid": "133220b5-0fbb-47c8-b615-2ba6dbb6cd03"
            },
            {
              "@type": "WorkflowRoute",
              "name": "add user DV details -> Identify Target System",
              "targetStep": "/api/3/workflow_steps/00dc8318-d6cb-47c1-9865-6d352e5fc163",
              "sourceStep": "/api/3/workflow_steps/16321386-e35d-48ef-a74a-557a756b122f",
              "label": null,
              "isExecuted": false,
              "uuid": "154e3053-2117-4a11-809b-b0a22c4ecda5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy of add user DV details -> Upload Binary Input",
              "targetStep": "/api/3/workflow_steps/d7f6fb34-cd60-4bb0-9850-a1a86b58d12d",
              "sourceStep": "/api/3/workflow_steps/7f6dfd65-09a0-4c62-a38c-f316dea1839b",
              "label": null,
              "isExecuted": false,
              "uuid": "1f8001b7-95bf-461d-b706-1df1843f8c2e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Phase to Containment -> Stop instances",
              "targetStep": "/api/3/workflow_steps/bde6e19b-bf87-4ad1-9f95-1fc5b4e8674e",
              "sourceStep": "/api/3/workflow_steps/c725d6c1-3d9a-4e1a-9fbb-3b14e07db2fe",
              "label": null,
              "isExecuted": false,
              "uuid": "28cd13ad-a137-46de-8f87-07fb7bf10e9b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Stop instances -> Set Phase to Eradication",
              "targetStep": "/api/3/workflow_steps/0a8fe66f-749a-45ab-8301-8d45d142cd86",
              "sourceStep": "/api/3/workflow_steps/bde6e19b-bf87-4ad1-9f95-1fc5b4e8674e",
              "label": null,
              "isExecuted": false,
              "uuid": "2eea48d5-e97c-4c9b-a42a-f35c3b8f195a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Phase to Identification -> a",
              "targetStep": "/api/3/workflow_steps/2b2e379b-27b1-47eb-9807-2dbc689533e3",
              "sourceStep": "/api/3/workflow_steps/0a226751-074b-4b6d-8bbc-62390b99cfd2",
              "label": null,
              "isExecuted": false,
              "uuid": "372b07d4-2cbd-4174-87c0-9dc490e495f8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Copy of Copy of add user DV details -> Create Binary File Indicator 1",
              "targetStep": "/api/3/workflow_steps/a681e085-91c8-40af-83a9-c0e83876bb5b",
              "sourceStep": "/api/3/workflow_steps/6ec6e58b-2a15-4a8b-ab03-0eb6a7acb969",
              "label": null,
              "isExecuted": false,
              "uuid": "3c7643b0-e9e2-4b8a-bac2-5c07450e02ae"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Add details of Splunk query to record -> Set Phase to Containment",
              "targetStep": "/api/3/workflow_steps/c725d6c1-3d9a-4e1a-9fbb-3b14e07db2fe",
              "sourceStep": "/api/3/workflow_steps/8ba7df92-3818-49e0-8b97-3d940c7f7ff2",
              "label": null,
              "isExecuted": false,
              "uuid": "3fddca0e-1907-4e80-a3c0-acdcafab0a8b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Upload Binary Input -> Copy  of Fetch User Details_Binary File",
              "targetStep": "/api/3/workflow_steps/ce88e54d-78ae-4c45-ace9-8c9e8d77731c",
              "sourceStep": "/api/3/workflow_steps/d7f6fb34-cd60-4bb0-9850-a1a86b58d12d",
              "label": "Upload",
              "isExecuted": false,
              "uuid": "6772b9e0-a7d3-47e2-9172-5f4ab9ea58f5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Restore Corrupted Files -> Start instances",
              "targetStep": "/api/3/workflow_steps/b8aad193-8889-4937-a45b-6b56e9cf6194",
              "sourceStep": "/api/3/workflow_steps/ed0f8624-de7d-45c7-9020-44eb261762bf",
              "label": null,
              "isExecuted": false,
              "uuid": "87d260eb-6404-4a47-991e-e9e1e1dc7fd7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Query Splunk for related events for source IP address -> Retrieve Splunk query results",
              "targetStep": "/api/3/workflow_steps/e08077af-bd9a-4098-aeb3-c9e07b130dc5",
              "sourceStep": "/api/3/workflow_steps/601fdce5-cde2-44ad-82c6-5a292106e895",
              "label": null,
              "isExecuted": false,
              "uuid": "8ccd862c-19f7-4212-ba37-7ea3e93415c4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Phase to Confirmation -> Query Splunk for related events for source IP address",
              "targetStep": "/api/3/workflow_steps/601fdce5-cde2-44ad-82c6-5a292106e895",
              "sourceStep": "/api/3/workflow_steps/5ae13628-d09a-446d-9d08-8b2bf4fa913c",
              "label": null,
              "isExecuted": false,
              "uuid": "8e7fccfc-aaa5-4f70-a403-f77e6fe6b036"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Binary File Indicator 1 -> Set Phase to Confirmation",
              "targetStep": "/api/3/workflow_steps/5ae13628-d09a-446d-9d08-8b2bf4fa913c",
              "sourceStep": "/api/3/workflow_steps/a681e085-91c8-40af-83a9-c0e83876bb5b",
              "label": null,
              "isExecuted": false,
              "uuid": "90ea7010-07a0-4a5d-8c24-ba6b7fa5e489"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Set Phase to Identification",
              "targetStep": "/api/3/workflow_steps/0a226751-074b-4b6d-8bbc-62390b99cfd2",
              "sourceStep": "/api/3/workflow_steps/1f51590d-6596-4f22-8a66-302a75acdd32",
              "label": null,
              "isExecuted": false,
              "uuid": "95316215-86fa-4178-96f5-86a60517315d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Upload Binary Input -> No Binary file comment",
              "targetStep": "/api/3/workflow_steps/349edc27-132e-458b-9d1d-676260b11a59",
              "sourceStep": "/api/3/workflow_steps/d7f6fb34-cd60-4bb0-9850-a1a86b58d12d",
              "label": "No Binary Found",
              "isExecuted": false,
              "uuid": "9ff91260-f3fa-4713-87bb-a7d7c55025a7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Phase to Recovery -> Restore Corrupted Files",
              "targetStep": "/api/3/workflow_steps/ed0f8624-de7d-45c7-9020-44eb261762bf",
              "sourceStep": "/api/3/workflow_steps/a2c8e2a7-76af-4af7-9304-0d39583687e2",
              "label": null,
              "isExecuted": false,
              "uuid": "a3f43a06-5414-47a7-8869-9505e59213d1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Identify Target System -> Copy  of Set Delivery Vector",
              "targetStep": "/api/3/workflow_steps/200696d3-30fe-434d-84ec-45dc6da644a6",
              "sourceStep": "/api/3/workflow_steps/00dc8318-d6cb-47c1-9865-6d352e5fc163",
              "label": "Save",
              "isExecuted": false,
              "uuid": "b441e89e-0131-4151-9714-b6e43b2f1f2b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Phase to Eradication -> Write a Procedure",
              "targetStep": "/api/3/workflow_steps/b1b259b2-a625-4f47-9819-eb392144fd6e",
              "sourceStep": "/api/3/workflow_steps/0a8fe66f-749a-45ab-8301-8d45d142cd86",
              "label": null,
              "isExecuted": false,
              "uuid": "b4d4ddf3-ece2-452b-bca3-1c46a44f4ebf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Binary File Hash -> Copy of Copy of add user DV details",
              "targetStep": "/api/3/workflow_steps/6ec6e58b-2a15-4a8b-ab03-0eb6a7acb969",
              "sourceStep": "/api/3/workflow_steps/ce88e54d-78ae-4c45-ace9-8c9e8d77731c",
              "label": null,
              "isExecuted": false,
              "uuid": "b887b813-329b-43a1-947b-b158962e49b2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Target Asset -> Copy of add user DV details",
              "targetStep": "/api/3/workflow_steps/7f6dfd65-09a0-4c62-a38c-f316dea1839b",
              "sourceStep": "/api/3/workflow_steps/200696d3-30fe-434d-84ec-45dc6da644a6",
              "label": null,
              "isExecuted": false,
              "uuid": "cfcda791-0bc7-4cb3-ab08-81372c4ed992"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configurations",
              "targetStep": "/api/3/workflow_steps/1f51590d-6596-4f22-8a66-302a75acdd32",
              "sourceStep": "/api/3/workflow_steps/80d50b11-83fa-427c-bf7e-c6ed11686798",
              "label": null,
              "isExecuted": false,
              "uuid": "ef591bff-3927-4bc7-8234-8a7925e444ad"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Identify Delivery Vector -> Set Delivery Vector",
              "targetStep": "/api/3/workflow_steps/2e74416d-bb90-4095-8b8d-e21dc67c61eb",
              "sourceStep": "/api/3/workflow_steps/2b2e379b-27b1-47eb-9807-2dbc689533e3",
              "label": "Save",
              "isExecuted": false,
              "uuid": "f06241ac-28c5-4195-b241-fae07696e04e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Phase to Aftermath -> Add task completed note to Incident",
              "targetStep": "/api/3/workflow_steps/87556d28-5a2e-42d7-9a80-6992ffee0bc5",
              "sourceStep": "/api/3/workflow_steps/85c8d415-ee02-4da7-98b3-971e1b233734",
              "label": null,
              "isExecuted": false,
              "uuid": "fd591dc3-974f-43f7-8a66-df115f87d449"
            },
            {
              "@type": "WorkflowRoute",
              "name": "No Binary file comment -> Set Phase to Confirmation",
              "targetStep": "/api/3/workflow_steps/5ae13628-d09a-446d-9d08-8b2bf4fa913c",
              "sourceStep": "/api/3/workflow_steps/349edc27-132e-458b-9d1d-676260b11a59",
              "label": null,
              "isExecuted": false,
              "uuid": "fff27c0f-bcbf-4876-99f1-6db499d0848e"
            }
          ],
          "priority": null,
          "uuid": "15a6b90b-dc47-48e1-aab4-c3df6460490c",
          "id": 3122,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1654295767.156292,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1654296787.344823,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [
            {
              "apiName": "sOARFramework",
              "name": "SOAR Framework",
              "version": "1.0.0"
            }
          ],
          "recordTags": [
            "ManualAction",
            "Incidents"
          ]
        }
      ]
    }
  ],
  "macros": [
    {
      "name": "Current_Date",
      "value": "{{arrow.utcnow().timestamp}}",
      "default_value": "{{arrow.utcnow().timestamp}}"
    },
    {
      "name": "Current_User",
      "value": "{{vars.currentUser}}",
      "default_value": "{{vars.currentUser}}"
    }
  ],
  "exported_tags": [
    "ManualAction",
    "Incidents"
  ]
}